from code.tests import testingtools
from code.search_code import searchdata
import pytest


def expected_tfidf():
    return [('http://people.scs.carleton.ca/~davidmckenney/fruits/N-128.html', 'peach', 0.01507262712743627),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-128.html', 'banana', 0.026435697651786105),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-128.html', 'coconut', 0.007642508877644972),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-128.html', 'apple', 0.014161063490706421),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-128.html', 'pear', 0.015886562565125537),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-128.html', 'tomato', 0.0),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-722.html', 'peach', 0.014307045475623087),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-722.html', 'banana', 0.01646917062056189),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-722.html', 'coconut', 0.016371547269107223),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-722.html', 'apple', 0.01217813669875404),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-722.html', 'pear', 0.019443581172158126),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-722.html', 'tomato', 0.0),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-871.html', 'peach', 0.00982173918215607),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-871.html', 'banana', 0.01923116078623852),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-871.html', 'coconut', 0.0215626226256398),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-871.html', 'apple', 0.012598064527532328),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-871.html', 'pear', 0.015886562565125537),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-871.html', 'tomato', 0.0),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-444.html', 'peach', 0.01209643459154539),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-444.html', 'banana', 0.0031423938279027314),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-444.html', 'coconut', 0.024443089428098932),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-444.html', 'apple', 0.013431897262154007),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-444.html', 'pear', 0.02286107235814336),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-444.html', 'tomato', 0.0),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-178.html', 'peach', 0.015235713081979433),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-178.html', 'banana', 0.008718228088337566),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-178.html', 'coconut', 0.02291213569987703),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-178.html', 'apple', 0.021898246475129658),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-178.html', 'pear', 0.00792681277814716),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-178.html', 'tomato', 0.0),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-226.html', 'peach', 0.014307045475623087),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-226.html', 'banana', 0.01923116078623852),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-226.html', 'coconut', 0.015491066507565628),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-226.html', 'apple', 0.010906072415966224),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-226.html', 'pear', 0.019055451996668523),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-226.html', 'tomato', 0.0),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-196.html', 'peach', 0.014307045475623087),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-196.html', 'banana', 0.018465793366799335),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-196.html', 'coconut', 0.0181055999688694),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-196.html', 'apple', 0.014974147360882971),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-196.html', 'pear', 0.013120144314836671),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-196.html', 'tomato', 0.0),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-894.html', 'peach', 0.01284024581822718),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-894.html', 'banana', 0.01923116078623852),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-894.html', 'coconut', 0.013902877591502586),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-894.html', 'apple', 0.021358710040301147),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-894.html', 'pear', 0.011756175313239121),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-894.html', 'tomato', 0.0),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-629.html', 'peach', 0.009753827886802994),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-629.html', 'banana', 0.013148590639014034),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-629.html', 'coconut', 0.014864011018402363),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-629.html', 'apple', 0.01736884373111887),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-629.html', 'pear', 0.0234504873846046),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-629.html', 'tomato', 0.0),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-259.html', 'peach', 0.022574842851635843),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-259.html', 'banana', 0.01923116078623852),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-259.html', 'coconut', 0.008952022920533313),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-259.html', 'apple', 0.017485412117501323),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-259.html', 'pear', 0.009180573341547111),
            ('http://people.scs.carleton.ca/~davidmckenney/fruits/N-259.html', 'tomato', 0.0),
            ('http://people.scs.carleton.ca/~davidmckenney/tinyfruits/N.html', 'peach', 0.0),
            ('http://people.scs.carleton.ca/~davidmckenney/tinyfruits/N.html', 'banana', 0.0),
            ('http://people.scs.carleton.ca/~davidmckenney/tinyfruits/N.html', 'coconut', 0.0),
            ('http://people.scs.carleton.ca/~davidmckenney/tinyfruits/N.html', 'apple', 0.0),
            ('http://people.scs.carleton.ca/~davidmckenney/tinyfruits/N.html', 'pear', 0.0),
            ('http://people.scs.carleton.ca/~davidmckenney/tinyfruits/N.html', 'tomato', 0.0),
            ]


@pytest.mark.parametrize('url, fruit, expected', expected_tfidf())
def test_tfidf(run_crawler, url, fruit, expected):
    result = searchdata.get_tf_idf(url, fruit)
    assert testingtools.compare_doubles(result, expected)